This is an Eclipse plug-in that allows running [JDeodorant](https://github.com/tsantalis/JDeodorant) for identifying refactoring opportunities and applying them in the batch mode.

# Running the headless mode within Eclipse
You can run this application from within Eclipse. Please follow these steps:

1. Download (or clone) jdeodorant-commandline and [JDeodorant](https://github.com/tsantalis/JDeodorant) plug-in and import them as existing projects into your Eclipse workspace.

2. Right-click on the *JDeodorant-Commandline* project and select *Run As* > *Run Configurations...*

3. Click on *Eclipse Application* and then on the *New launch configuration* button. Give a name to the newly-created launch configuration.

4. In the *Main* tab:
    * In the *Workspace Data*, setup the *Location* to point to the workspace containing the projects that you want to analyze in the headless mode.
	The projects which are going to be analyzed will be opened in this workspace. 
	There are two options to open Java projects (that you are going to analyze) in the workspace:
		- The workspace directory is created by Eclipse. In this case, it can be created by clicking on *File* > *Switch Workspace* and specifying a new workspace directory, and then creating a new project (or importing the existing one) to Eclipse.
    You can import multiple projects that you want to analyze.
		After you are done, you should switch back to the original workspace where JDeodorant and jdeodorant-commandline plug-ins are imported.
		- You can ask the tool to try importing an existing Eclipse project automatically. In this case, the workspace is created in the given path by the tool, and the project is imported to it. You'll need to use the `-pd` switch to specify the path to the `.project` file of the project (See the table below).
	
        Note that, in any case, Eclipse project files should exist for the Java project that you want to analyze.
	* In the *Program to Run* select to *Run an application* and from the drop-down list select `ca.concordia.jdeodorant.eclipse.commandline.application`.

5. In the *Arguments* tab specify the *Program arguments* (refer to the following table).

6. Next, specify the *VM arguments* as `-Xms128m -Xmx4096m -XX:PermSize=128m` (you can increase the Xmx value, if more memory is available).

7. In the *Plug-ins* tab first select *plug-ins selected below only* in the *Launch with:* drop-down list. Then select `ca.concordia.jdeodorant.eclipse.commandline (1.0.0.qualifier)` and click on *Add Required Plug-ins* button.

8. Apply the changes in order to save the new Launch Configuration.
Click *Run* to test whether the headless plug-in works properly. If you are getting `BundleException`, go back to the *Plug-ins* tab (step 7) and select *Launch with*: *all workspace and enabled target plug-ins*. Apply the changes and Run again the headless plug-in.

# Running as a standalone command-line application 

We have provided the necessary means for generating an **Eclipse product** that can be run from the OS command-line as a standalone executable, without the need for opening Eclipse for running. This is particularly useful if, for instance, one needs to integrate JDeodorant in their current development workflow (e.g., using continuous integration). 

The Eclipse product is an executable file along with the necessary plug-in dependencies. The entire package can be generated by Eclipse, one for each platform. We have tested the product on Windows and Mac. 

To generate the executable for your target platform, follow these steps:

  1. Download (or clone) jdeodorant-commandline and [JDeodorant](https://github.com/tsantalis/JDeodorant) plug-in and import them as existing projects into your Eclipse workspace
  (You will need Eclipse only to generate the Eclipse product, which runs from the OS commandline).

  2. In the commandline project, double click on `ProductConfiguration.product`. The *Product Configuration Editor* should be opened (If not, you might be missing necessary plug-ins installed on your Eclipse. We tested on *Eclipse IDE for Java EE Developers*).

  3. If you need to configure the generated product, you can use the *Configuration* and *Launching* tabs, which allow changing parameters for the generated product for different platforms. For instance, you might want to change the `eclipse.ini` file that the target product will use, or provide additional VM arguments.

  4. From the *Overview* tab, under the *Exporting* section, choose *Eclipse Product Export Wizard*.

  5. In the shown wizard, `/JDeodorant-Commandline/ProductConfiguration.product` should be selected as *Configuration*. Specify a directory under the *Destination* section, and click *Finish*.

  6. A folder containing the final Eclipse Product will be created. Look for the file `\eclipse\eclipse.exe` or `\MacOS\eclipse`, which is the executable for the product.

  7. Open a command line, switch to the folder containing the executable file (found in the previous step) and run the product's executable. You should provide necessary arguments, as mentioned in the following table. For instance, you can run (on Windows):

  ```
  eclipse.exe -p projectName -m print_opportunities
  ```
